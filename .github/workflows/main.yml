name: Contentful Migration Example

on: [push]

jobs:
  build:

    runs-on: ubuntu-latest
    name: Contentful Migration Example
    steps:
    - name: Check out code into the directory
      uses: actions/checkout@v1

    - name: Contentful Migration
      id: migrate
      uses: contentful/contentful-action@v1.1
      env: # Set the secret as an input
        SPACE_ID: ${{ secrets.SPACE_ID }}
        MANAGEMENT_API_KEY: ${{ secrets.MANAGEMENT_API_KEY }}
        MIGRATIONS_DIR: ${{ secrets.MIGRATIONS_DIR }}

    - name: output testing
      run: |
          echo ${{steps.migrate.outputs.environment_name}}
          echo ${{steps.migrate.outputs.environment_url}}

    - name: Create commit comment
      uses: peter-evans/commit-comment@v1
      with:
        body: |
          ${{steps.migrate.outputs.*}}
          ${{steps.migrate.outputs.environment_name}}
          See changes to Contentful Enviroment [${{steps.migrate.outputs.environment_name }} ][1]

          [1]: ${{steps.migrate.outputs.environment_url}}

    - name: Hello world action step
      id: hello
      uses: actions/hello-world-javascript-action@v1
      with:
        who-to-greet: 'Mona the Octocat'
    # Use the output from the `hello` step
    - name: Get the output time
      run: echo "The time was ${{ steps.hello.outputs.time }}"

    - name: Create commit comment
      uses: peter-evans/commit-comment@v1
      with:
        body: |
          The time is ${{ steps.hello.outputs.time }}
